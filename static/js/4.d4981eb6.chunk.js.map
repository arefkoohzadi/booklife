{"version":3,"sources":["hooks/useUserBooks.js","components/myBook/DeleteBook.js","components/myBook/BookTable.js","components/myBook/NumberStatus.js","components/myBook/MyBooks.js"],"names":["useUserBooks","books","useSelector","state","book","userId","auth","filter","status","Object","keys","some","id","DeleteBook","bookId","token","dispatch","useDispatch","url","handleDelete","a","httpRequest","delete","deleteStatus","console","log","onClick","className","fill","stroke","viewBox","xmlns","strokeLinecap","strokeLinejoin","strokeWidth","d","BookTable","props","authors","author","myBooks","getAuthorId","find","au","name","map","key","src","imageUrl","alt","to","title","StarRating","DropDown","NumberStatus","allMyBooks","length","currentReading","read","willRead","forEach","MyBooks","isAuth","history","useHistory","useEffect","window","scrollTo","localStorage","getItem","authCheckState","replace","Helmet","Details"],"mappings":"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","file":"static/js/4.d4981eb6.chunk.js","sourcesContent":["import { useSelector } from \"react-redux\";\r\n\r\nconst useUserBooks = () => {\r\n  const books = useSelector((state) => state.book.books);\r\n  const userId = useSelector((state) => state.auth.userId);\r\n\r\n  const myBooks = books.filter((book) => {\r\n    if (!!book.status) {\r\n      const userIds = Object.keys(book.status);\r\n      return userIds.some((id) => id === userId);\r\n    }\r\n    return false;\r\n  });\r\n\r\n  return [myBooks, userId];\r\n};\r\n\r\nexport default useUserBooks;\r\n","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { deleteStatus } from \"../../store/actions/book\";\r\nimport httpRequest from \"../../api/axios-books\";\r\n\r\nconst DeleteBook = ({ bookId }) => {\r\n  const userId = useSelector((state) => state.auth.userId);\r\n  const token = useSelector((state) => state.auth.token);\r\n  const dispatch = useDispatch();\r\n\r\n  const url = `/books/${bookId}/status/${userId}.json?auth=${token}`;\r\n  const handleDelete = async () => {\r\n    try {\r\n      await httpRequest.delete(url);\r\n      dispatch(deleteStatus(bookId, userId));\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <svg\r\n      onClick={handleDelete}\r\n      className=\"w-8 h-8 text-gray-600 hover:text-gray-700 hover:bg-blue-200 hover:bg-opacity-25 cursor-pointer rounded-full p-1\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      viewBox=\"0 0 24 24\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth={2}\r\n        d=\"M6 18L18 6M6 6l12 12\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default DeleteBook;\r\n","import React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport useUserBooks from \"../../hooks/useUserBooks\";\r\nimport DropDown from \"../common/DropDown\";\r\nimport StarRating from \"../common/StarRating\";\r\nimport DeleteBook from \"./DeleteBook\";\r\n\r\nconst BookTable = (props) => {\r\n  const authors = useSelector((state) => state.author.authors);\r\n\r\n  const [myBooks] = useUserBooks();\r\n\r\n  const getAuthorId = (book) => {\r\n    let author = authors.find((au) => au.name === book.author);\r\n    return author ? author.id : null;\r\n  };\r\n  return (\r\n    <div className=\"container mx-auto\">\r\n      <div className=\"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto\">\r\n        <div className=\"inline-block min-w-full shadow rounded-lg overflow-y-auto\">\r\n          <table className=\"min-w-full leading-normal table-fixed\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"px-5 py-3 border-b-2 w-16 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  تصویر\r\n                </th>\r\n                <th className=\"pl-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  عنوان\r\n                </th>\r\n                <th className=\"pl-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  نویسنده\r\n                </th>\r\n                <th className=\"pl-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  امتیاز\r\n                </th>\r\n                <th className=\"pl-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  وضعیت\r\n                </th>\r\n                <th className=\"pl-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-right text-xs font-semibold font-IRANSans text-gray-600 uppercase tracking-wider\">\r\n                  حذف\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {myBooks.map((book) => (\r\n                <tr\r\n                  key={book.id}\r\n                  className=\"odd:bg-white even:bg-gray-100 hover:bg-gray-100\"\r\n                >\r\n                  <td className=\"px-5 py-5 border-b w-16 border-gray-200 text-sm\">\r\n                    <div className=\"flex items-center\">\r\n                      <div className=\"flex-shrink-0 w-10 h-10\">\r\n                        <img\r\n                          className=\"w-full h-full rounded-full\"\r\n                          src={book.imageUrl}\r\n                          alt=\"\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"pl-5 py-5 border-b border-gray-200  text-sm\">\r\n                    <Link\r\n                      to={`/book/${book.id}`}\r\n                      className=\"text-gray-900 border-b border-transparent whitespace-no-wrap hover:border-gray-900\"\r\n                    >\r\n                      {book.title}\r\n                    </Link>\r\n                  </td>\r\n                  <td className=\"pl-5 py-5 border-b border-gray-200  text-sm\">\r\n                    <Link\r\n                      to={`/author/${getAuthorId(book)}`}\r\n                      className=\"text-gray-900 border-b border-transparent whitespace-no-wrap hover:border-gray-900\"\r\n                    >\r\n                      {book.author}\r\n                    </Link>\r\n                  </td>\r\n                  <td className=\"pl-5 py-5 border-b border-gray-200  text-sm\">\r\n                    <StarRating bookId={book.id} />\r\n                  </td>\r\n                  <td className=\"pl-5 py-5 border-b border-gray-200 text-sm\">\r\n                    <DropDown bookId={book.id} />\r\n                  </td>\r\n                  <td className=\"pl-5 py-5 border-b border-gray-200  text-sm\">\r\n                    <DeleteBook bookId={book.id} />\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookTable;\r\n","import React from \"react\";\r\nimport useUserBooks from \"../../hooks/useUserBooks\";\r\n\r\nconst NumberStatus = (props) => {\r\n  const [myBooks, userId] = useUserBooks();\r\n  const allMyBooks = myBooks.length;\r\n  let currentReading = 0;\r\n  let read = 0;\r\n  let willRead = 0;\r\n\r\n  myBooks.forEach((book) => {\r\n    const userIds = Object.keys(book.status);\r\n    const status = userIds.find((id) => id === userId);\r\n    if (book.status[status] === \"در حال خواندن\") {\r\n      currentReading++;\r\n    } else if (book.status[status] === \"می‌خواهم بخوانم\") {\r\n      willRead++;\r\n    } else if (book.status[status] === \"خواندم\") {\r\n      read++;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <h1 className=\"font-IRANSansMedium text-gray-800 text-lg\">قفسه کتاب</h1>\r\n      <div className=\"flex md:flex-col\">\r\n        <div className=\"ml-3 md:ml-0\">\r\n          <h2 className=\"text-gray-700\">\r\n            همه{\" \"}\r\n            <span className=\"font-IRANSansFaNum text-gray-700\">\r\n              ({allMyBooks})\r\n            </span>\r\n          </h2>\r\n          <h2 className=\"text-gray-700\">\r\n            خوانده{\" \"}\r\n            <span className=\"font-IRANSansFaNum text-gray-700\">({read})</span>\r\n          </h2>\r\n        </div>\r\n        <div>\r\n          <h2 className=\"text-gray-700\">\r\n            در حال خواندن{\" \"}\r\n            <span className=\"font-IRANSansFaNum text-gray-700\">\r\n              ({currentReading})\r\n            </span>\r\n          </h2>\r\n          <h2 className=\"text-gray-700\">\r\n            در لیست خواندن{\" \"}\r\n            <span className=\"font-IRANSansFaNum text-gray-700\">\r\n              ({willRead})\r\n            </span>\r\n          </h2>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default NumberStatus;\r\n","import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport Details from \"../common/Details\";\r\nimport BookTable from \"./BookTable\";\r\nimport { authCheckState } from \"../../store/actions/auth\";\r\nimport NumberStatus from \"./NumberStatus\";\r\n\r\nconst MyBooks = (props) => {\r\n  const isAuth = !!useSelector((state) => state.auth.token);\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isAuth) {\r\n      const token = localStorage.getItem(\"token\");\r\n      if (!token) {\r\n        history.replace(\"/\");\r\n      } else {\r\n        dispatch(authCheckState());\r\n      }\r\n    }\r\n  }, [history, dispatch, isAuth]);\r\n\r\n  return (\r\n    <div className=\"mt-3\">\r\n      <Helmet>\r\n        <title>کتاب‌های من</title>\r\n      </Helmet>\r\n      <Details title=\"کتاب‌های من\" />\r\n      <div className=\"md:flex\">\r\n        <div className=\"md:w-2/12 mt-5\">\r\n          <NumberStatus />\r\n        </div>\r\n        <div className=\"md:w-10/12 mt-2\">\r\n          <BookTable />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyBooks;\r\n"],"sourceRoot":""}